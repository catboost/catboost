RESOURCES_LIBRARY()



INCLUDE(resources.inc)

IF (USE_SYSTEM_PYTHON)
    IF (OS_LINUX)
        IF (ARCH_ARM64 OR ARCH_AARCH64)
            IF (_SYSTEM_PYTHON27)
                DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON27_LINUX_ARM64})
            ELSE()
                ENABLE(PYTHON_NOT_FOUND)
            ENDIF()
        ELSEIF (ARCH_X86_64)
            IF (_SYSTEM_PYTHON27)
                DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON27_LINUX})
            ELSEIF (_SYSTEM_PYTHON34)
                DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON34_LINUX})
            ELSEIF (_SYSTEM_PYTHON35)
                DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON35_LINUX})
            ELSEIF (_SYSTEM_PYTHON36)
                DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON36_LINUX})
            ELSEIF (_SYSTEM_PYTHON37)
                DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON37_LINUX})
            ELSEIF (_SYSTEM_PYTHON38)
                DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON38_LINUX})
            ELSEIF (_SYSTEM_PYTHON39)
                DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON39_LINUX})
            ELSEIF (_SYSTEM_PYTHON310)
                DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON310_LINUX})
            ELSE()
                ENABLE(PYTHON_NOT_FOUND)
            ENDIF()
        ELSE()
            ENABLE(PYTHON_NOT_FOUND)
        ENDIF()
        CFLAGS(
            GLOBAL "-I$EXTERNAL_PYTHON_RESOURCE_GLOBAL/python/include"
            GLOBAL "-I$EXTERNAL_PYTHON_RESOURCE_GLOBAL/python/include/python${PY_VERSION}"
        )
    ELSEIF (OS_DARWIN)
        IF (PYTHON_DISTR == "macos-brew")
            IF (ARCH_X86_64)
                IF (_SYSTEM_PYTHON27)
                    DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON sbr:562720527)
                ELSEIF (_SYSTEM_PYTHON36)
                    DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON sbr:562721643)
                ELSE()
                    ENABLE(PYTHON_NOT_FOUND)
                ENDIF()
            ELSE()
                ENABLE(PYTHON_NOT_FOUND)
            ENDIF()
        ELSE()
            IF (ARCH_X86_64)
                IF (_SYSTEM_PYTHON27)
                    DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON27_DARWIN})
                ELSEIF (_SYSTEM_PYTHON34)
                    DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON34_DARWIN})
                ELSEIF (_SYSTEM_PYTHON35)
                    DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON35_DARWIN})
                ELSEIF (_SYSTEM_PYTHON36)
                    DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON36_DARWIN})
                ELSEIF (_SYSTEM_PYTHON37)
                    DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON37_DARWIN})
                ELSEIF (_SYSTEM_PYTHON38)
                    DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON38_DARWIN})
                ELSEIF (_SYSTEM_PYTHON39)
                    DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON39_DARWIN})
                ELSEIF (_SYSTEM_PYTHON310)
                    DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON310_DARWIN})
                ELSE()
                    ENABLE(PYTHON_NOT_FOUND)
                ENDIF()
            ELSE()
                ENABLE(PYTHON_NOT_FOUND)
            ENDIF()
        ENDIF()
        CFLAGS(GLOBAL "-I$EXTERNAL_PYTHON_RESOURCE_GLOBAL/python/Python.framework/Versions/${PY_FRAMEWORK_VERSION}/include/python${PY_VERSION}")
    ELSEIF (OS_WINDOWS)
        IF (ARCH_X86_64)
            IF (_SYSTEM_PYTHON27)
                DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON27_WINDOWS})
            ELSEIF (_SYSTEM_PYTHON34)
                DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON34_WINDOWS})
            ELSEIF (_SYSTEM_PYTHON35)
                DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON35_WINDOWS})
            ELSEIF (_SYSTEM_PYTHON36)
                DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON36_WINDOWS})
            ELSEIF (_SYSTEM_PYTHON37)
                DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON37_WINDOWS})
            ELSEIF (_SYSTEM_PYTHON38)
                DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON38_WINDOWS})
            ELSEIF (_SYSTEM_PYTHON39)
                DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON39_WINDOWS})
            ELSEIF (_SYSTEM_PYTHON310)
                DECLARE_EXTERNAL_RESOURCE(EXTERNAL_PYTHON ${PYTHON310_WINDOWS})
            ELSE()
                ENABLE(PYTHON_NOT_FOUND)
            ENDIF()
        ELSE()
            ENABLE(PYTHON_NOT_FOUND)
        ENDIF()
        CFLAGS(GLOBAL "/I$EXTERNAL_PYTHON_RESOURCE_GLOBAL/python/include")
        LDFLAGS("/LIBPATH:$EXTERNAL_PYTHON_RESOURCE_GLOBAL/python/libs")
    ENDIF()

    IF (PYTHON_NOT_FOUND)
        MESSAGE(FATAL_ERROR "No system Python ${USE_SYSTEM_PYTHON} for the selected platform")
    ENDIF()
ELSEIF (NOT USE_ARCADIA_PYTHON)
    CFLAGS(GLOBAL $PYTHON_FLAGS)
    IF (OS_WINDOWS)
        LDFLAGS($PYTHON_LDFLAGS $PYTHON_LIBRARIES)
    ENDIF()
ENDIF()

END()

RECURSE_FOR_TESTS(
    tests
)
